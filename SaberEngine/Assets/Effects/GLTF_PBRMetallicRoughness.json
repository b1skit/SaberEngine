{
	"Effect": {
		"Name": "GLTF_PBRMetallicRoughness",
		"Parents": ["Common"],
		"DrawStyles": [
			{
				"Conditions": [
					{ "Rule": "RenderPath", "Mode": "Deferred" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Opaque" },
					{ "Rule": "MaterialSidedness", "Mode": "Single" }
				],
				"Technique": "FillGBuffer_SingleSided"
			},
			{
				"Conditions": [
					{ "Rule": "RenderPath", "Mode": "Deferred" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Mask" },
					{ "Rule": "MaterialSidedness", "Mode": "Single" }
				],
				"Technique": "FillGBuffer_SingleSided"
			},
			{
				"Conditions": [
					{ "Rule": "RenderPath", "Mode": "Deferred" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Opaque" },
					{ "Rule": "MaterialSidedness", "Mode": "Double" }
				],
				"Technique": "FillGBuffer_DoubleSided"
			},
			{
				"Conditions": [
					{ "Rule": "RenderPath", "Mode": "Deferred" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Mask" },
					{ "Rule": "MaterialSidedness", "Mode": "Double" }
				],
				"Technique": "FillGBuffer_DoubleSided"
			},
			{
				"Conditions": [
					{ "Rule": "RenderPath", "Mode": "Forward" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Blend" },
					{ "Rule": "MaterialSidedness", "Mode": "Single" }
				],
				"Technique": "AlphaBlend_SingleSided"
			},
			{
				"Conditions": [
					{ "Rule": "RenderPath", "Mode": "Forward" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Blend" },
					{ "Rule": "MaterialSidedness", "Mode": "Double" }
				],
				"Technique": "AlphaBlend_DoubleSided"
			},
			{
				"Conditions": [
					{ "Rule": "Shadow", "Mode": "2D" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Opaque" },
					{ "Rule": "MaterialSidedness", "Mode": "Single" }
				],
				"Technique": "Shadow_2D_SingleSided_Opaque"
			},
			{
				"Conditions": [
					{ "Rule": "Shadow", "Mode": "2D" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Mask" },
					{ "Rule": "MaterialSidedness", "Mode": "Single" }
				],
				"Technique": "Shadow_2D_SingleSided_AlphaMask"
			},
			{
				"Conditions": [
					{ "Rule": "Shadow", "Mode": "2D" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Opaque" },
					{ "Rule": "MaterialSidedness", "Mode": "Double" }
				],
				"Technique": "Shadow_2D_DoubleSided_Opaque"
			},
			{
				"Conditions": [
					{ "Rule": "Shadow", "Mode": "2D" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Mask" },
					{ "Rule": "MaterialSidedness", "Mode": "Double" }
				],
				"Technique": "Shadow_2D_DoubleSided_AlphaMask"
			},
			{
				"Conditions": [
					{ "Rule": "Shadow", "Mode": "Cube" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Opaque" },
					{ "Rule": "MaterialSidedness", "Mode": "Single" }
				],
				"Technique": "Shadow_Cube_SingleSided_Opaque"
			},
			{
				"Conditions": [
					{ "Rule": "Shadow", "Mode": "Cube" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Mask" },
					{ "Rule": "MaterialSidedness", "Mode": "Single" }
				],
				"Technique": "Shadow_Cube_SingleSided_AlphaMask"
			},
			{
				"Conditions": [
					{ "Rule": "Shadow", "Mode": "Cube" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Opaque" },
					{ "Rule": "MaterialSidedness", "Mode": "Double" }
				],
				"Technique": "Shadow_Cube_DoubleSided_Opaque"
			},
			{
				"Conditions": [
					{ "Rule": "Shadow", "Mode": "Cube" },
					{ "Rule": "MaterialAlphaMode", "Mode": "Mask" },
					{ "Rule": "MaterialSidedness", "Mode": "Double" }
				],
				"Technique": "Shadow_Cube_DoubleSided_AlphaMask"
			}
		]
	},

	"PipelineStates": [
		{
			"Name": "SingleSided",
			"FaceCullingMode": "Back",
			"DepthTestMode": "Less"
		},
		{
			"Name": "DoubleSided",
			"FaceCullingMode": "Disabled",
			"DepthTestMode": "Less"
		}
	],

	"Techniques": [
		{
			"Name": "FillGBuffer_SingleSided",
			"VShader": "GLTF_PBRMetallicRoughness_VShader",
			"PShader": "GLTF_PBRMetallicRoughness_GBufferFill_PShader",
			"PipelineState": "SingleSided",
			"VertexStream": "Default"
		},
		{
			"Name": "FillGBuffer_DoubleSided",
			"VShader": "GLTF_PBRMetallicRoughness_VShader",
			"PShader": "GLTF_PBRMetallicRoughness_GBufferFill_PShader",
			"PipelineState": "DoubleSided",
			"VertexStream": "Default"
		},

		{
			"Name": "AlphaBlend_SingleSided",
			"VShader": "GLTF_PBRMetallicRoughness_Transparency_VShader",
			"PShader": "GLTF_PBRMetallicRoughness_Transparency_PShader",
			"PipelineState": "SingleSided",
			"VertexStream": "Default"
		},
		{
			"Name": "AlphaBlend_DoubleSided",
			"VShader": "GLTF_PBRMetallicRoughness_Transparency_VShader",
			"PShader": "GLTF_PBRMetallicRoughness_Transparency_PShader",
			"PipelineState": "DoubleSided",
			"VertexStream": "Default"
		},
		
		// TODO: FaceCullingMode::Disabled is better for minimizing peter-panning, but we need backface culling if we
		// want to be able to place lights inside of geometry (eg. emissive spheres). For now, enable backface culling.
		// In future, we need to support tagging assets to not cast shadows at load time
		{
			"Name": "Shadow_2D_SingleSided_Opaque",
			"VShader": "Depth_VShader",
			"PipelineState": "SingleSided",
			"VertexStream": "Default"
		},
		{
			"Name": "Shadow_2D_SingleSided_AlphaMask",
			"VShader": "DepthAlphaMask_VShader",
			"PShader": "DepthAlphaMask_PShader",
			"PipelineState": "SingleSided",
			"VertexStream": "Default"
		},
		{
			"Name": "Shadow_2D_DoubleSided_Opaque",
			"VShader": "Depth_VShader",
			"PipelineState": "DoubleSided",
			"VertexStream": "Default"
		},
		{
			"Name": "Shadow_2D_DoubleSided_AlphaMask",
			"VShader": "DepthAlphaMask_VShader",
			"PShader": "DepthAlphaMask_PShader",
			"PipelineState": "DoubleSided",
			"VertexStream": "Default"
		},
		{
			"Name": "Shadow_Cube_SingleSided_Opaque",
			"VShader": "CubeDepth_VShader",
			"GShader": "CubeDepth_GShader",
			"PipelineState": "SingleSided",
			"VertexStream": "Default"
		},
		{
			"Name": "Shadow_Cube_SingleSided_AlphaMask",
			"VShader": "CubeDepthAlphaMask_VShader",
			"GShader": "CubeDepthAlphaMask_GShader",
			"PShader": "DepthAlphaMask_PShader",
			"PipelineState": "SingleSided",
			"VertexStream": "Default"
		},
		{
			"Name": "Shadow_Cube_DoubleSided_Opaque",
			"VShader": "CubeDepth_VShader",
			"GShader": "CubeDepth_GShader",
			"PipelineState": "DoubleSided",
			"VertexStream": "Default"
		},
		{
			"Name": "Shadow_Cube_DoubleSided_AlphaMask",
			"VShader": "CubeDepthAlphaMask_VShader",
			"GShader": "CubeDepthAlphaMask_GShader",
			"PShader": "DepthAlphaMask_PShader",
			"PipelineState": "DoubleSided",
			"VertexStream": "Default"
		}
	]
}